<p-toast></p-toast>
<div class="create-market-container">

  <app-header [title]="title"></app-header>

  <div class="scrollable-content">
    <form [formGroup]="marketForm" (ngSubmit)="onSubmit()">
      
      
      <div class="form-section">
        <label for="region" class="form-label">{{ 'PAGE.LABELS.REGION' | translate }} <span class="asterik">*</span></label>
        <p class="form-sub-label">{{ 'PAGE.PLACEHOLDERS.SELECT_REGION' | translate }}</p>
        <div class="region-options">
          <div
            class="region-option"
            *ngFor="let region of regions"
            [ngClass]="{ selected: selectedRegion === region.key }"
            (click)="onRegionSelect(region.key)"
          >
            <p-radioButton
              [name]="'region'"
              [label]="region.value"
              [inputId]="region.key.toString()"
              [value]="region.key"
              formControlName="region"
            >
            </p-radioButton>
            <label class="check-box-labels" [for]="region.key.toString()"
              >- {{ region.value }}</label
            >
          </div>
        </div>
      </div>

      <div *ngIf="subregions.length > 0" class="form-section">
        <label for="subregion" class="form-label">{{ 'PAGE.LABELS.SUBREGION' | translate }} <span class="asterik">*</span></label>
        <p class="form-sub-label">{{ 'PAGE.PLACEHOLDERS.SELECT_SUBREGION' | translate }}</p>
        <div class="subregion-options">
          <div 
            class="subregion-option" 
            *ngFor="let subregion of subregions" 
            [ngClass]="{'selected': selectedSubregion === subregion.key.toString()}"
            (click)="onSubregionChange($event, subregion.key)">
            <p-radioButton 
              [name]="'subregion'" 
              [label]="subregion.value" 
              [inputId]="subregion.key.toString()" 
              [value]="subregion.key" 
              formControlName="subregion">
            </p-radioButton>
            <label class="check-box-labels" [for]="subregion.key.toString()">{{ subregion.value }}</label>
          </div>
        </div>
      </div>

      <div class="form-section">
        <label class="form-label">{{ 'PAGE.LABELS.SHORT_CODE_MARKET_NAME' | translate }} <span class="asterik">*</span></label>
        <p class="form-sub-label">{{ 'PAGE.PLACEHOLDERS.ENTER_CODE' | translate }} and {{ 'PAGE.PLACEHOLDERS.ENTER_NAME' | translate }}</p>
        <div class="shortcode-marketname-container">
            <input 
                formControlName="marketCode" 
                type="text" 
                placeholder="{{ 'PAGE.PLACEHOLDERS.ENTER_CODE' | translate }}" 
                class="shortcode-input" 
                maxlength="2"  
                autocapitalize="on"
            />
            <span class="divider"></span>
            <input 
                formControlName="marketName" 
                type="text" 
                placeholder="{{ 'PAGE.PLACEHOLDERS.ENTER_NAME' | translate }}" 
                class="marketname-input" 
            />
        </div>
        
        
        <p *ngIf="codeExistsError" class="error-message">
            <span class="error-icon">❗</span> {{ 'PAGE.PLACEHOLDERS.ERROR_MARKET_CODE_EXISTS' | translate }}
        </p>

      
        <p *ngIf="nameExistsError" class="error-message">
            <span class="error-icon">❗</span> {{ 'PAGE.PLACEHOLDERS.ERROR_MARKET_NAME_EXISTS' | translate }}
        </p>
      </div>

      

      <div class="form-section">
        <label class="form-label"
          >Long  Code <span class="asterik">*</span></label
        >
        <p class="form-sub-label">
          The format will be automatically set based on selections
        </p>
        <div class="input-wrapper">
       
          <p-inputMask #longCodeInput
          formControlName="longCode"
          [mask]="longCodeMask"
 
          (focus)="setCursorToEditable($event)"
          placeholder="_-__.__.__"
          class="longcode-input">
          </p-inputMask>
        </div>
      </div>

      
      <button 
        type="submit" 
        class="submit-button" 
        [disabled]="marketForm.invalid">
        {{ 'PAGE.BUTTONS.SUBMIT' | translate }}
      </button>
    </form>
  </div>
</div>  
